{% extends 'core/base.html' %}

{% block title %}Manage Access | FraudGuard AI{% endblock %}

{% block content %}
<div class="box">
    <h2>Manage Access: {{ managed_user.username }}</h2>
    <p class="subtitle">Assign roles and control account status</p>

    <form method="post" class="card" style="padding: 2rem; background: var(--glass-surface-light);">
        {% csrf_token %}

        <div class="form-group">
            <label>Select System Role</label>
            <select name="role" required>
                {% for code, label in roles %}
                <option value="{{ code }}" {% if managed_user.profile.role==code %}selected{% endif %}>
                    {{ label }}
                </option>
                {% endfor %}
            </select>
            <p class="help-text">Roles define which modules (Analysis, Reports, etc.) this user can access.</p>
        </div>

        <div class="form-group" style="display: flex; align-items: center; gap: 1rem; margin-top: 1rem;">
            <label style="margin-bottom: 0;">Account Active</label>
            <input type="checkbox" name="is_active" {% if managed_user.is_active %}checked{% endif %}
                style="width: auto;">
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
            <button type="submit" class="button">Save Permissions</button>
            <a href="{% url 'user_list' %}" class="button secondary">Cancel</a>
        </div>
    </form>

    <div class="risk-reason-box" style="margin-top: 2rem;">
        <h4>Role Permissions Guide</h4>
        <ul style="font-size: 0.9rem;">
            <li><strong>Admin:</strong> Full system access, including User Management.</li>
            <li><strong>Fraud Analyst:</strong> Access to Fraud Prediction and Bulk Analysis.</li>
            <li><strong>Compliance / Auditor:</strong> Access to Historical Reports & CSV Exports.</li>
            <li><strong>User:</strong> Access to Quick Prediction tool.</li>
        </ul>
    </div>
</div>
{% endblock %}